---
layout: post
title: 错误代码集锦
categories: java
---

## {{ page.title }}

{{ page.date | date: "%Y.%-m.%-d" }} | <a href="/archive#{{ page.categories }}">{{ page.categories}}</a>

1.

错误信息:

```
2017-12-29 02:14:31 [http-8080-1] [com.justep.business.server.BusinessServer] ERROR: excute stream action, params:{"accept":"application/json",
"action":"queryProdOrderMatListWithoutJointProdAction","actionFlag":"__action_0__","activity":"mainActivity","contentType":"json","executeContext":"",
"executor":"","parameters":{"isCalc":true,"masterId":"AF51E6ACB02D4393B2C00485D65BC466","quantity":"[Decimal:undefined]","unit":"KG"},
"process":"/eppenpf/pp/process/prodOrder/prodOrderProcess"}
java.lang.NumberFormatException
	at java.math.BigDecimal.<init>(BigDecimal.java:494)
	at java.math.BigDecimal.<init>(BigDecimal.java:383)
	at java.math.BigDecimal.<init>(BigDecimal.java:806)
	at com.justep.system.transform.SimpleTransform.a(Unknown Source)
	at com.justep.system.transform.SimpleTransform.transToObj(Unknown Source)
	at com.justep.system.transform.SimpleTransform.transJsonToObject(Unknown Source)
	at com.justep.system.transform.ParameterTransform.transParamByJson(Unknown Source)
	at com.justep.system.transform.ParameterTransform.helpTransform(Unknown Source)
	at com.justep.system.transform.ParameterTransform.transform(Unknown Source)
	at com.justep.system.transform.RequestTransform.transParamValue(Unknown Source)
	at com.justep.system.transform.RequestTransform.transActionParams(Unknown Source)
	at com.justep.system.transform.RequestTransform.transform(Unknown Source)
	at com.justep.system.action.Engine.translateParameters(Unknown Source)
	at com.justep.system.action.Engine.invokeActions(Native Method)
	at com.justep.system.action.Engine.invokeActions(Unknown Source)
	at com.justep.business.server.BusinessServer.doAction(Unknown Source)
	at com.justep.business.server.BusinessServer.doExcute(Unknown Source)
	at com.justep.business.server.BusinessServer.excute(Unknown Source)
	at com.justep.business.server.BusinessServer.excute(Unknown Source)
	at com.justep.business.server.BusinessServerServlet.execService(Unknown Source)
	at com.justep.business.server.BusinessServerServlet.service(Unknown Source)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:723)
	at com.justep.x.bs.BusinessServerServlet.service(Unknown Source)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:723)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)
	at com.googlecode.psiprobe.Tomcat60AgentValve.invoke(Tomcat60AgentValve.java:40)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:103)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:293)
	at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:861)
	at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:606)
	at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:489)
	at java.lang.Thread.run(Thread.java:745)
```

原因: 前台的调用action参数quantity: param.setDecimal("quantity", mainData.getValue("CONFIRM_QUANTITY")); 当mainData.getValue没有赋值时,为undefined导致类型转换失败
说明: 当传输数据时,必须进行校验,哪些必须有值,哪些可以没有值

2.

错误信息:

```
2017-12-28 22:41:08 [http-8080-2] [com.justep.business.server.BusinessServer] ERROR: excute stream action, params:{"accept":"application/json",
"action":"confirmApportionmentAction","actionFlag":"__action_0__","activity":"mainActivity","contentType":"json","executeContext":"","executor":"",
"parameters":{"detailIds":["22FBB334FA6B449BBBAE623A7368B0AA","26529C371A824FFA87721E6A1821912F","2D40988E31B84D44995ACDEBA278C500","6081CEEF218D413997BA20C0B644909C",
"90044BFE225840398A47608904EAB1BB","50C181356BEB43B1942E6F5A935FA8F9","F399CF84B5254F31BBDB79F208A4C47A"],"header":{"DOC_DATE":"[DateTime:2017-12-28T00:00:00.000Z]",
"HEADER_TXT":"生产订单确认分摊","MOVE_TYPE":"261","PSTNG_DATE":"[DateTime:2017-12-28T00:00:00.000Z]","id":"F275B7C588584591AD48EFC491EAD3D5"}},
"process":"/eppenpf/pp/process/confirmApportionment/confirmApportionmentProcess"}
java.lang.reflect.InvocationTargetException
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:497)
	at com.justep.system.action.Engine.invokeActions(Native Method)
	at com.justep.system.action.Engine.invokeActions(Unknown Source)
	at com.justep.business.server.BusinessServer.doAction(Unknown Source)
	at com.justep.business.server.BusinessServer.doExcute(Unknown Source)
	at com.justep.business.server.BusinessServer.excute(Unknown Source)
	at com.justep.business.server.BusinessServer.excute(Unknown Source)
	at com.justep.business.server.BusinessServerServlet.execService(Unknown Source)
	at com.justep.business.server.BusinessServerServlet.service(Unknown Source)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:723)
	at com.justep.x.bs.BusinessServerServlet.service(Unknown Source)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:723)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)
	at com.googlecode.psiprobe.Tomcat60AgentValve.invoke(Tomcat60AgentValve.java:40)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:103)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:293)
	at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:861)
	at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:606)
	at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:489)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.lang.RuntimeException: 操作失败,没有数据
	at Confirm.confirmApportionment(Confirm.java:326)
	... 28 more
```

代码信息:

```
public static Map<String, Object> confirmApportionment(Map header, List detailIds) throws JCoException {
	Map<String, Object> tips = new HashMap<String, Object>();
	tips.put(Constants.FLAG, false);
	
	String concept = "D_PP_CONFIRM_APPORTIONMENT1";
	
	String sql = "SELECT id.* FROM " + concept + " id WHERE id in(" + CommonBuilder.buildSqlInCondition(detailIds) + ")";
	Table table = KSQL.select(sql, null, ppDataModel, null);	
	
	if (table.size() == 0) {
		throw new RuntimeException("操作失败,没有数据"); // Confirm.java:326
	} else {
```

原因: 前台数据没有保存, 直接提交调用后台action, 导致后台查询不到数据
说明: 当后台有根据前台查询的, 必须确保数据已经保存

3.

错误信息:

```
2017-12-29 09:12:14 [http-8080-2] [com.justep.business.server.BusinessServer] ERROR: excute stream action, params:{"accept":"application/json",
"action":"REQUIREMENTS_SHEET","actionFlag":"__action_0__","activity":"mainActivity","contentType":"json","executeContext":"","executor":"",
"parameters":{},"process":"/eppenpf/pp/process/demand/demandProcess"}
java.lang.reflect.InvocationTargetException
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:497)
	at com.justep.system.action.Engine.invokeActions(Native Method)
	at com.justep.system.action.Engine.invokeActions(Unknown Source)
	at com.justep.business.server.BusinessServer.doAction(Unknown Source)
	at com.justep.business.server.BusinessServer.doExcute(Unknown Source)
	at com.justep.business.server.BusinessServer.excute(Unknown Source)
	at com.justep.business.server.BusinessServer.excute(Unknown Source)
	at com.justep.business.server.BusinessServerServlet.execService(Unknown Source)
	at com.justep.business.server.BusinessServerServlet.service(Unknown Source)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:723)
	at com.justep.x.bs.BusinessServerServlet.service(Unknown Source)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:723)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)
	at com.googlecode.psiprobe.Tomcat60AgentValve.invoke(Tomcat60AgentValve.java:40)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:103)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:293)
	at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:861)
	at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:606)
	at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:489)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.lang.NullPointerException
	at Pp.REQUIREMENTS_SHEET(Pp.java:2963)
	... 28 more
```

对应的代码如下: 

```
public static void REQUIREMENTS_SHEET() {

	String dataModel = "/eppenpf/pp/data";

	String sql = "SELECT max(id.MON) as M FROM REQUIREMENTS_SHEET id ";

	Table ta = KSQL.select(sql, null, dataModel, null);
	String MON = "";

	if (ta.size() != 0) {
		Iterator<Row> r1 = ta.iterator();

		while (r1.hasNext()) {
			Row re = r1.next();
			MON = re.getString("M");
		}
	}

	String sq = "SELECT max(id.PERIO) as M FROM D_PROD_PLAN_DETAIL_LIST id ";

	Table table = KSQL.select(sq, null, dataModel, null);
	String MONS = "";
	if (table.size() != 0) {
		Iterator<Row> r = table.iterator();

		while (r.hasNext()) {
			Row re = r.next();
			MONS = re.getString("M");
		}
	}
	HashMap<String, Object> var = new HashMap<String, Object>();

	Calendar cal = Calendar.getInstance();
	int year = cal.get(Calendar.YEAR);
	int month = cal.get(Calendar.MONTH) + 1;

	String mo = year + "" + month;

	if (MONS != "" && MONS != null) {

		if (MON.equals(MONS)) { // Pp.java:2963  当sql或sq查询返回空时,即MON=null,此处报Caused by: java.lang.NullPointerException at Pp.REQUIREMENTS_SHEET(Pp.java:2963)
	......
```

说明: String判断空时,必须判断str != null && !"".equals(str), 直接str != ""是错误的

4.

代码信息:

```
public static void sheetSQL(HashMap<String, Object> var) {

	String dataModel = "/eppenpf/pp/data";

	String sqls = "SELECT sum(id.CONSUMPTION) as CONSUMPTION,id.PERIO,id.WERKS,id.MATNR FROM D_PROD_PLAN_DETAIL_LIST id where :MON = id.PERIO group by id.PERIO,id.WERKS,id.MATNR ";
	Table t = KSQL.select(sqls, var, dataModel, null);

	Iterator<Row> row = t.iterator();

	Map<String, List<String[]>> importTableParam = new HashMap<String, List<String[]>>();
	String[] str;// = new String[2]
	List<String[]> list;

	while (row.hasNext()) {
		Row re = row.next();
		String CONSUMPTION = "";

		if (re.getDecimal("CONSUMPTION") != null) {
			CONSUMPTION = re.getDecimal("CONSUMPTION").toString();
		}

		String PERIO = re.getString("PERIO");
		String WERKS = re.getString("WERKS");
		String MATNR = re.getString("MATNR");

		String sun = PERIO + "," + MATNR;
		list = importTableParam.get(sun);
		// ---------------
		if (list == null) {
			list = new ArrayList<String[]>();
			importTableParam.put(sun, list);
		}
		str = new String[2];
		str[0] = WERKS;
		str[1] = CONSUMPTION;

		list.add(str);
		// ----------------
	}

	Iterator<String> keys = importTableParam.keySet().iterator();
	String concept = "REQUIREMENTS_SHEET";

	int batchcount = 5000;
	int index = 0;
	String preparSql = "(FID,VERSION,MATNR,MON,DEMAND_1100,DEMAND_1200,DEMAND_1300,DEMAND_1400,DEMAND_1500,DEMAND_9100) VALUES(?,?,?,?,?,?,?,?,?,?)";
	String updaSql = "MATNR = ?,MON = ?,DEMAND_1100 = ?,DEMAND_1200 = ?,DEMAND_1300 = ?,DEMAND_1400 = ?,DEMAND_1500 = ?,DEMAND_9100 = ? where FID = ? ";
	try {

		Connection conn = ModelUtils.getConnectionInTransaction(dataModel);
		String insertSql = "INSERT INTO " + concept + " " + preparSql;
		String updateSql = "UPDATE " + concept + " SET " + updaSql;
		PreparedStatement insertps = null;
		PreparedStatement update = null;

		insertps = conn.prepareStatement(insertSql);
		update = conn.prepareStatement(updateSql);

		while (keys.hasNext()) {
			index++;
			String key = keys.next();
			String[] k = key.split(",");
			String PERIO = k[0];
			String MATNR = k[1];
			String a = "0";

			list = importTableParam.get(key);

			String selectSql = "select * from " + concept + " id where id.FID = '" + key + "'";
			Table tab = SQL.select(selectSql, null, dataModel);

			if (tab.size() == 0) {

				for (int i = 0; i < list.size(); i++) {
					String[] values = list.get(i);
					String WERKS = values[0];
					String CONSUMPTION = values[1];

					if ("".equals(CONSUMPTION)) {
						CONSUMPTION = "0";
					}
					insertps.setString(1, key);
					insertps.setInt(2, 0);
					insertps.setString(3, MATNR);
					insertps.setString(4, PERIO);
					BigDecimal w1100 = BigDecimal.ZERO;
					BigDecimal w1200 = BigDecimal.ZERO;
					BigDecimal w1300 = BigDecimal.ZERO;
					BigDecimal w1400 = BigDecimal.ZERO;
					BigDecimal w1500 = BigDecimal.ZERO;
					BigDecimal w9100 = BigDecimal.ZERO;

					if ("1100".equals(WERKS)) {
						w1100 = new BigDecimal(CONSUMPTION);
					}

					if ("1200".equals(WERKS)) {
						w1200 = new BigDecimal(CONSUMPTION);
					}

					if ("1300".equals(WERKS)) {
						w1300 = new BigDecimal(CONSUMPTION);
					} else {
						w1300 = new BigDecimal(0);
					}

					if ("1400".equals(WERKS)) {
						w1400 = new BigDecimal(CONSUMPTION);
					}

					if ("1500".equals(WERKS)) {
						w1500 = new BigDecimal(CONSUMPTION);
					}

					if ("9100".equals(WERKS)) {
						w9100 = new BigDecimal(CONSUMPTION);
					}

					insertps.setBigDecimal(5, w1100);
					insertps.setBigDecimal(6, w1200);
					insertps.setBigDecimal(7, w1300);
					insertps.setBigDecimal(8, w1400);
					insertps.setBigDecimal(9, w1500);
					insertps.setBigDecimal(10, w9100);

				}
			} else {
				a = "1";
				for (int i = 0; i < list.size(); i++) {
					String[] values = list.get(i);
					String WERKS = values[0];
					String CONSUMPTION = values[1];

					if ("".equals(CONSUMPTION)) {
						CONSUMPTION = "0";
					}
					update.setString(1, MATNR);
					update.setString(2, PERIO);
					BigDecimal w1100 = BigDecimal.ZERO;
					BigDecimal w1200 = BigDecimal.ZERO;
					BigDecimal w1300 = BigDecimal.ZERO;
					BigDecimal w1400 = BigDecimal.ZERO;
					BigDecimal w1500 = BigDecimal.ZERO;
					BigDecimal w9100 = BigDecimal.ZERO;

					if ("1100".equals(WERKS)) {
						w1100 = new BigDecimal(CONSUMPTION);
					}

					if ("1200".equals(WERKS)) {
						w1200 = new BigDecimal(CONSUMPTION);
					}

					if ("1300".equals(WERKS)) {
						w1300 = new BigDecimal(CONSUMPTION);
					} else {
						w1300 = new BigDecimal(0);
					}

					if ("1400".equals(WERKS)) {
						w1400 = new BigDecimal(CONSUMPTION);
					}

					if ("1500".equals(WERKS)) {
						w1500 = new BigDecimal(CONSUMPTION);
					}

					if ("9100".equals(WERKS)) {
						w9100 = new BigDecimal(CONSUMPTION);
					}

					update.setBigDecimal(3, w1100);
					update.setBigDecimal(4, w1200);
					update.setBigDecimal(5, w1300);
					update.setBigDecimal(6, w1400);
					update.setBigDecimal(7, w1500);
					update.setBigDecimal(8, w9100);
					update.setString(9, key);
				}
			}
			if (a == "0") {
				insertps.addBatch();
				if (index > 0 && index % batchcount == 0) {
					index = 0;
					insertps.executeBatch();
				}
			} else {
				update.addBatch();
				if (index > 0 && index % batchcount == 0) {
					index = 0;
					update.executeBatch();
				}
			}

		}
		update.executeBatch();
		update.close();

		insertps.executeBatch();
		insertps.close();
		conn.close();
	} catch (Exception e) {
		e.printStackTrace();
	}
}
```

说明: 数据库连接在有异常的时候, 关闭不上, 导致内存泄漏, 自定义connection时, 必须在finally中关闭

5. 

错误信息:

```
2017-12-28 17:03:25 [http-8080-5] [com.justep.business.server.BusinessServer] ERROR: excute stream action, params:{"accept":"application/json",
"action":"updateSapD_PAYMENTAction","actionFlag":"__action_0__","activity":"mainActivity","contentType":"json","executeContext":"","executor":"",
"parameters":{"args":[{"ALLOT":"","ITEM_TEXT":"yhby2017120020","SNUM":"99"},{"ALLOT":"40040305","ITEM_TEXT":"收蛋白粉款"},{"ALLOT":"40040305","ITEM_TEXT":"收蛋白粉款"}],
"fID":"682D49DB959440D6937F834CE8397B40"},"process":"/eppenpf/sd/process/sd_payment/sd_paymentProcess"}
java.lang.reflect.InvocationTargetException
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:497)
	at com.justep.system.action.Engine.invokeActions(Native Method)
	at com.justep.system.action.Engine.invokeActions(Unknown Source)
	at com.justep.business.server.BusinessServer.doAction(Unknown Source)
	at com.justep.business.server.BusinessServer.doExcute(Unknown Source)
	at com.justep.business.server.BusinessServer.excute(Unknown Source)
	at com.justep.business.server.BusinessServer.excute(Unknown Source)
	at com.justep.business.server.BusinessServerServlet.execService(Unknown Source)
	at com.justep.business.server.BusinessServerServlet.service(Unknown Source)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:723)
	at com.justep.x.bs.BusinessServerServlet.service(Unknown Source)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:723)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)
	at com.googlecode.psiprobe.Tomcat60AgentValve.invoke(Tomcat60AgentValve.java:40)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:103)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:293)
	at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:861)
	at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:606)
	at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:489)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.lang.NullPointerException
	at SDPayment.updateSapD_PAYMENTAction(SDPayment.java:964)
	... 28 more
```

代码信息: 

```
public static Map<String, Object> updateSapD_PAYMENTAction(String fID, List args) throws JCoException {
	System.out.println(args);

	Map<String, Object> result = new HashMap<String, Object>();
	result.put("flag", false);
	result.put("message", "操作失败");

	try {
		Map<String, List<Map<String, Object>>> importTableParams = new HashMap<String, List<Map<String, Object>>>();
		List<Map<String, Object>> tables = new ArrayList<Map<String, Object>>();
		Map<String, Object> tableMap1 = new HashMap<String, Object>();

		String dataModel = "/eppenpf/sd/data";
		HashMap<String, Object> vers = new HashMap<String, Object>();
		vers.put("fid", fID);
		// 查询子表填充
		String sql1 = "select purchase.* from D_PAYMENT purchase where purchase = :fid ";
		Table maintable = KSQL.select(sql1, vers, dataModel, null);
		Iterator<Row> mainRows = maintable.iterator();
		while (mainRows.hasNext()) {

			Row rw = mainRows.next();
			tableMap1.put("BELNR", rw.getString("PAYING_CODE"));
			tableMap1.put("BUZEI", "99");
			// 公司代码
			tableMap1.put("BUKRS", rw.getString("COMP_CODE"));
			// 会计年度
			tableMap1.put("GJAHR", rw.getInt("FISC_YEAR"));
			// 项目文本

			for (Object arg : args) {
				Map entry = (Map) arg;
				String snum = entry.get("SNUM").toString();  // SDPayment.java:964
				String ITEM_TEXT = entry.get("ITEM_TEXT").toString();
				if (snum.equals("99")) {
					tableMap1.put("ITEM_TEXT", ITEM_TEXT);
				}
			}
			tables.add(tableMap1);
			String sql2 = " select detail.* from D_PAYMENT_DETAIL detail where detail.PAY_ID = :fid ";
			Table tableDetail = KSQL.select(sql2, vers, dataModel, null);
			Iterator<Row> rowsDetail = tableDetail.iterator();
			while (rowsDetail.hasNext()) {
				Map<String, Object> tableMap2 = new HashMap<String, Object>();
				Row rw2 = rowsDetail.next();
				tableMap2.put("BELNR", rw.getString("PAYING_CODE"));
				tableMap2.put("BUZEI", rw2.getString("SNUM"));
				// 公司代码
				tableMap2.put("BUKRS", rw.getString("COMP_CODE"));
				// 会计年度
				tableMap2.put("GJAHR", rw.getInt("FISC_YEAR"));
				// 凭证类型
				tableMap2.put("BSCHL", rw2.getString("PK"));
				// 项目文本
				

				for (Object arg : args) {

					Map<?, ?> entry = (Map) arg;
					String snum = entry.get("SNUM").toString();
					String SGTXT = entry.get("ITEM_TEXT").toString();
					String ALLOT = entry.get("ALLOT").toString();
					if (snum.equals(rw2.getString("SNUM"))) {
						tableMap2.put("ITEM_TEXT", SGTXT);
						tableMap2.put("ALLOC_NMBR", ALLOT);
					}
				}

				tables.add(tableMap2);
			}
		}
		importTableParams.put("ET_ACC_DOC_TXT", tables);
		ParameterList exportParams = SapUtils.requestSap("Z_SD_ACC_DOC_TXT_EDIT", new HashMap<String, Object>(), importTableParams);
		// 上传成功，返回凭证号

		String message = exportParams.getString("E_MESSAGE");
		String type = exportParams.getString("E_RETURN");
		if ("E".equals(type) == false) {
			result.put("flag", true);
		} else {
			result.put("message", message);
		}

	} catch (JCoException e) {
		e.printStackTrace();
	}
	return result;
}
```

原因: entry.get("SNUM")为空而报异常(HashMap中允许键值可以为null)
说明: 
  * 变量在使用函数的时候, 必须进行判断是否为空
  * System.out.println(args); 不应该出现在正式代码中
  * e.printStackTrace(); 不是正确的处理异常方式

6.

错误信息:

```
com.justep.model.exception.ModelException: 编码: JUSTEP151005; 提示: 定义Activity "/eppenpf/sd/process/sd_saleOrder/sd_saleOrderProcess,mainActivity"出错, 
"/eppenpf/sd/process/sd_saleOrder/sd_saleOrderProcess,mainActivity"中不存在Action "checkStoreOnChangeAction"
	at com.justep.model.exception.ModelException.create(Unknown Source)
	at com.justep.model.impl.ActivityImpl.getAction(Unknown Source)
	at com.justep.system.action.Engine.invokeActions(Native Method)
	at com.justep.system.action.Engine.invokeActions(Unknown Source)
	at com.justep.business.server.BusinessServer.doAction(Unknown Source)
	at com.justep.business.server.BusinessServer.doExcute(Unknown Source)
	at com.justep.business.server.BusinessServer.excute(Unknown Source)
	at com.justep.business.server.BusinessServer.excute(Unknown Source)
	at com.justep.business.server.BusinessServerServlet.execService(Unknown Source)
	at com.justep.business.server.BusinessServerServlet.service(Unknown Source)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:723)
	at com.justep.x.bs.BusinessServerServlet.service(Unknown Source)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:723)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)
	at com.googlecode.psiprobe.Tomcat60AgentValve.invoke(Tomcat60AgentValve.java:40)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:103)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:293)
	at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:861)
	at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:606)
	at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:489)
	at java.lang.Thread.run(Thread.java:745)
```

原因: 没有引用checkStoreOnChangeAction

7.

错误信息:

```
2017-12-28 16:54:18 [http-8080-5] [com.justep.business.server.BusinessServer] ERROR: excute stream action, params:{"accept":"application/json",
"action":"unitConvertAction","actionFlag":"__action_0__","activity":"mainActivity","contentType":"json","executeContext":"","executor":"",
"parameters":{"fromUnit":"kg","materialNo":"000000006000000146","quantity":0.85,"toUnit":"T"},"process":"/eppenpf/sd/process/sd_retailOrder/sd_retailOrderProcess"}
java.lang.reflect.InvocationTargetException
	at sun.reflect.GeneratedMethodAccessor508.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:497)
	at com.justep.system.action.Engine.invokeActions(Native Method)
	at com.justep.system.action.Engine.invokeActions(Unknown Source)
	at com.justep.business.server.BusinessServer.doAction(Unknown Source)
	at com.justep.business.server.BusinessServer.doExcute(Unknown Source)
	at com.justep.business.server.BusinessServer.excute(Unknown Source)
	at com.justep.business.server.BusinessServer.excute(Unknown Source)
	at com.justep.business.server.BusinessServerServlet.execService(Unknown Source)
	at com.justep.business.server.BusinessServerServlet.service(Unknown Source)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:723)
	at com.justep.x.bs.BusinessServerServlet.service(Unknown Source)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:723)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)
	at com.googlecode.psiprobe.Tomcat60AgentValve.invoke(Tomcat60AgentValve.java:40)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:103)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:293)
	at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:861)
	at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:606)
	at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:489)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.sap.conn.jco.AbapException: (126) ERROR_IN_APPLICATION: ERROR_IN_APPLICATION Message 094 of class 6R type E, Par[1]: 6000000146, Par[2]: ******
	at com.sap.conn.jco.rt.MiddlewareJavaRfc$JavaRfcClient.execute(MiddlewareJavaRfc.java:1875)
	at com.sap.conn.jco.rt.ClientConnection.execute(ClientConnection.java:1120)
	at com.sap.conn.jco.rt.ClientConnection.execute(ClientConnection.java:953)
	at com.sap.conn.jco.rt.RfcDestination.execute(RfcDestination.java:1465)
	at com.sap.conn.jco.rt.RfcDestination.execute(RfcDestination.java:1435)
	at com.sap.conn.jco.rt.AbapFunction.execute(AbapFunction.java:300)
	at com.eppen.sap.SapUtils.requestSap(SapUtils.java:317)
	at com.eppen.sap.SapUtils.requestSap(SapUtils.java:138)
	at com.eppen.common.stock.StockUtils.unitConvert(StockUtils.java:1994)
	at Stock.unitConvert(Stock.java:1974)
	... 27 more
```

8.项目库存

错误信息: 

在SAP新建一个WBS元素,然后进行101收货,但是在平台的项目库存没有相应的WBS元素,同步库存后,
再同步WBS元素后,再次再SAP做这个WBS的101收货,项目库存依然没有相应的WBS元素

原因: 
  * 第一次在SAP新建WBS后,直接进行101收货,在平台没有该WBS的项目库存,是因为WBS主数据没有进行同步,无法获取和转换
  * 第二次更新项目库存,重启服务器后,同步WBS主数据,在同步了WBS的主数据后,再进行SAP收货,还是没有WBS,
    是因为平台同步WBS主数据的时候,没有更新缓存里面的WBS主数据

9.

错误信息:

```
2018-01-14 02:01:10 [http-8080-4] [com.justep.business.server.BusinessServer] ERROR: excute stream action, params:{"accept":"application/json","action":"queryD_PROD_ORDERAction","actionFlag":"__action_0__","activity":"mainActivity","contentType":"json","executeContext":"","executor":"","parameters":{"columns":"ALLOCATION_NUM,ALLOCAT_FINISHED,AUART,AUART_DESC,AUFNR,AUTYP,AUTYP_DESC,BATCH,BATCH_MGR_FLAG,CONFIRM_FINISHED,CREATE_DEPT_FID,CREATE_DEPT_FNAME,CREATE_DEPT_ID,CREATE_DEPT_NAME,CREATE_PSN_FID,CREATE_PSN_FNAME,CREATE_PSN_ID,CREATE_PSN_NAME,CREATE_TIME,CY_SEQNR,DELETE_FLAG,DELIVERED,DISPO,D_PROD_ORDER,ELIKZ,FEVOR,FORM_STATUS,GAMNG,GLTRI,GMEIN,GSTRI,GSTRP,IGMNG,LOCKED,MASTER_ID,MATNR,MATXT,NOT_QUALIFIED,ORDER_STATUS,PARAM_FILE,PLAN_CODE,PLAN_FINISH_DATE,PLAN_ID,PRCTR,PRODCTION_SHIFT,PROD_DATE,RECV_FINISHED,RELEASE,RSNUM,R_PLNAL,R_PLNNR,SAP_FLAG,STATUS,STLAL,STORAGECODE,STTXT,UEBTO,UNTTO,UPDATE_PSN_ID,UPDATE_PSN_NAME,UPDATE_TIME,UP_STATUS,UP_STATUS_DESC,UP_TIME,VERID,WERKS,WORKSHOP,version","filter":"(DELETE_FLAG='0') AND (ORDER_STATUS>='1') AND ( (CREATE_PSN_FID LIKE '/4vd8EGQeqOJlztfkLvv.ogn/kR1oXaJfkTp38wFxOE0.dpt/xMvTeFm6aqqA2bUsnZa.dpt%')) AND (AUFNR like '%5601%') AND (RECV_FINISHED in('1'))","limit":20,"offset":0,"orderBy":"UPDATE_TIME DESC","variables":{}},"process":"/eppenpf/pp/process/orderRecv/orderRecvProcess","translateParameter":{"cellnameByRelation":false,"dataType":"row-list","includeState":true,"rowsConfig":{"concept":"D_PROD_ORDER","sequence":"ALLOCATION_NUM,ALLOCAT_FINISHED,AUART,AUART_DESC,AUFNR,AUTYP,AUTYP_DESC,BATCH,BATCH_MGR_FLAG,CONFIRM_FINISHED,CREATE_DEPT_FID,CREATE_DEPT_FNAME,CREATE_DEPT_ID,CREATE_DEPT_NAME,CREATE_PSN_FID,CREATE_PSN_FNAME,CREATE_PSN_ID,CREATE_PSN_NAME,CREATE_TIME,CY_SEQNR,DELETE_FLAG,DELIVERED,DISPO,D_PROD_ORDER,ELIKZ,FEVOR,FORM_STATUS,GAMNG,GLTRI,GMEIN,GSTRI,GSTRP,IGMNG,LOCKED,MASTER_ID,MATNR,MATXT,NOT_QUALIFIED,ORDER_STATUS,PARAM_FILE,PLAN_CODE,PLAN_FINISH_DATE,PLAN_ID,PRCTR,PRODCTION_SHIFT,PROD_DATE,RECV_FINISHED,RELEASE,RSNUM,R_PLNAL,R_PLNNR,SAP_FLAG,STATUS,STLAL,STORAGECODE,STTXT,UEBTO,UNTTO,UPDATE_PSN_ID,UPDATE_PSN_NAME,UPDATE_TIME,UP_STATUS,UP_STATUS_DESC,UP_TIME,VERID,WERKS,WORKSHOP,calcCheckBox,orderStatus,version"},"transformIdcolumn":true,"useNamespace":true}}
java.lang.reflect.InvocationTargetException
	at sun.reflect.GeneratedMethodAccessor190.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:497)
	at com.justep.system.action.Engine.invokeActions(Native Method)
	at com.justep.system.action.Engine.invokeActions(Unknown Source)
	at com.justep.business.server.BusinessServer.doAction(Unknown Source)
	at com.justep.business.server.BusinessServer.doExcute(Unknown Source)
	at com.justep.business.server.BusinessServer.excute(Unknown Source)
	at com.justep.business.server.BusinessServer.excute(Unknown Source)
	at com.justep.business.server.BusinessServerServlet.execService(Unknown Source)
	at com.justep.business.server.BusinessServerServlet.service(Unknown Source)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:723)
	at com.justep.x.bs.BusinessServerServlet.service(Unknown Source)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:723)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)
	at com.googlecode.psiprobe.Tomcat60AgentValve.invoke(Tomcat60AgentValve.java:40)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:103)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:293)
	at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:861)
	at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:606)
	at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:489)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.justep.exception.BusinessException: 编码: JUSTEP150210; 提示: 执行KSQL出错, KSQL: SELECT D_PROD_ORDER.*  FROM D_PROD_ORDER D_PROD_ORDER WHERE ((DELETE_FLAG='0') AND (ORDER_STATUS>='1') AND ( (CREATE_PSN_FID LIKE '/4vd8EGQeqOJlztfkLvv.ogn/kR1oXaJfkTp38wFxOE0.dpt/xMvTeFm6aqqA2bUsnZa.dpt%')) AND (AUFNR like '%5601%') AND (RECV_FINISHED in('1'))) ORDER BY UPDATE_TIME DESC LIMIT 0, 20
 --> sql: SELECT  D_PROD_ORDER.ALLOCATION_NUM AS ALLOCATION_NUM, D_PROD_ORDER.ALLOCAT_FINISHED AS ALLOCAT_FINISHED, D_PROD_ORDER.AUART AS AUART, D_PROD_ORDER.AUART_DESC AS AUART_DESC, D_PROD_ORDER.AUFNR AS AUFNR, D_PROD_ORDER.AUTYP AS AUTYP, D_PROD_ORDER.AUTYP_DESC AS AUTYP_DESC, D_PROD_ORDER.BATCH AS BATCH, D_PROD_ORDER.BATCH_MGR_FLAG AS BATCH_MGR_FLAG, D_PROD_ORDER.CONFIRM_FINISHED AS CONFIRM_FINISHED, D_PROD_ORDER.CREATE_DEPT_FID AS CREATE_DEPT_FID, D_PROD_ORDER.CREATE_DEPT_FNAME AS CREATE_DEPT_FNAME, D_PROD_ORDER.CREATE_DEPT_ID AS CREATE_DEPT_ID, D_PROD_ORDER.CREATE_DEPT_NAME AS CREATE_DEPT_NAME, D_PROD_ORDER.CREATE_PSN_FID AS CREATE_PSN_FID, D_PROD_ORDER.CREATE_PSN_FNAME AS CREATE_PSN_FNAME, D_PROD_ORDER.CREATE_PSN_ID AS CREATE_PSN_ID, D_PROD_ORDER.CREATE_PSN_NAME AS CREATE_PSN_NAME, D_PROD_ORDER.CREATE_TIME AS CREATE_TIME, D_PROD_ORDER.CY_SEQNR AS CY_SEQNR, D_PROD_ORDER.DELETE_FLAG AS DELETE_FLAG, D_PROD_ORDER.DELIVERED AS DELIVERED, D_PROD_ORDER.DISPO AS DISPO, D_PROD_ORDER.fID AS D_PROD_ORDER, D_PROD_ORDER.ELIKZ AS ELIKZ, D_PROD_ORDER.FEVOR AS FEVOR, D_PROD_ORDER.FORM_STATUS AS FORM_STATUS, D_PROD_ORDER.GAMNG AS GAMNG, D_PROD_ORDER.GLTRI AS GLTRI, D_PROD_ORDER.GMEIN AS GMEIN, D_PROD_ORDER.GSTRI AS GSTRI, D_PROD_ORDER.GSTRP AS GSTRP, D_PROD_ORDER.IGMNG AS IGMNG, D_PROD_ORDER.LOCKED AS LOCKED, D_PROD_ORDER.MASTER_ID AS MASTER_ID, D_PROD_ORDER.MATNR AS MATNR, D_PROD_ORDER.MATXT AS MATXT, D_PROD_ORDER.NOT_QUALIFIED AS NOT_QUALIFIED, D_PROD_ORDER.ORDER_STATUS AS ORDER_STATUS, D_PROD_ORDER.PARAM_FILE AS PARAM_FILE, D_PROD_ORDER.PLAN_CODE AS PLAN_CODE, D_PROD_ORDER.PLAN_FINISH_DATE AS PLAN_FINISH_DATE, D_PROD_ORDER.PLAN_ID AS PLAN_ID, D_PROD_ORDER.PRCTR AS PRCTR, D_PROD_ORDER.PRODCTION_SHIFT AS PRODCTION_SHIFT, D_PROD_ORDER.PROD_DATE AS PROD_DATE, D_PROD_ORDER.RECV_FINISHED AS RECV_FINISHED, D_PROD_ORDER.RELEASE AS RELEASE, D_PROD_ORDER.RSNUM AS RSNUM, D_PROD_ORDER.R_PLNAL AS R_PLNAL, D_PROD_ORDER.R_PLNNR AS R_PLNNR, D_PROD_ORDER.SAP_FLAG AS SAP_FLAG, D_PROD_ORDER.STATUS AS STATUS, D_PROD_ORDER.STLAL AS STLAL, D_PROD_ORDER.STORAGECODE AS STORAGECODE, D_PROD_ORDER.STTXT AS STTXT, D_PROD_ORDER.UEBTO AS UEBTO, D_PROD_ORDER.UNTTO AS UNTTO, D_PROD_ORDER.UPDATE_PSN_ID AS UPDATE_PSN_ID, D_PROD_ORDER.UPDATE_PSN_NAME AS UPDATE_PSN_NAME, D_PROD_ORDER.UPDATE_TIME AS UPDATE_TIME, D_PROD_ORDER.UP_STATUS AS UP_STATUS, D_PROD_ORDER.UP_STATUS_DESC AS UP_STATUS_DESC, D_PROD_ORDER.UP_TIME AS UP_TIME, D_PROD_ORDER.VERID AS VERID, D_PROD_ORDER.WERKS AS WERKS, D_PROD_ORDER.WORKSHOP AS WORKSHOP, D_PROD_ORDER.VERSION AS version FROM D_PROD_ORDER D_PROD_ORDER  WHERE  (DELETE_FLAG = ?) AND (ORDER_STATUS >= ?) AND (CREATE_PSN_FID LIKE ?) AND (AUFNR LIKE ?) AND ( RECV_FINISHED IN (?) )   ORDER BY UPDATE_TIME DESC
 --> binds: [0, 1, /4vd8EGQeqOJlztfkLvv.ogn/kR1oXaJfkTp38wFxOE0.dpt/xMvTeFm6aqqA2bUsnZa.dpt%, %5601%, 1]
	at com.justep.exception.BusinessException.create(Unknown Source)
	at com.justep.system.data.impl.TableUtilsImplement.ksqlSelect(Unknown Source)
	at com.justep.system.data.impl.TableUtilsImplement.ksqlSelect(Unknown Source)
	at com.justep.system.data.impl.TableUtilsImplement.ksqlSelect(Unknown Source)
	at com.justep.system.data.BizData.query(Unknown Source)
	at BizProcedure.query(BizProcedure.java:12)
	... 27 more
Caused by: com.justep.exception.BusinessException: 编码: JUSTEP150039; 提示: 执行sql: SELECT  D_PROD_ORDER.ALLOCATION_NUM AS ALLOCATION_NUM, D_PROD_ORDER.ALLOCAT_FINISHED AS ALLOCAT_FINISHED, D_PROD_ORDER.AUART AS AUART, D_PROD_ORDER.AUART_DESC AS AUART_DESC, D_PROD_ORDER.AUFNR AS AUFNR, D_PROD_ORDER.AUTYP AS AUTYP, D_PROD_ORDER.AUTYP_DESC AS AUTYP_DESC, D_PROD_ORDER.BATCH AS BATCH, D_PROD_ORDER.BATCH_MGR_FLAG AS BATCH_MGR_FLAG, D_PROD_ORDER.CONFIRM_FINISHED AS CONFIRM_FINISHED, D_PROD_ORDER.CREATE_DEPT_FID AS CREATE_DEPT_FID, D_PROD_ORDER.CREATE_DEPT_FNAME AS CREATE_DEPT_FNAME, D_PROD_ORDER.CREATE_DEPT_ID AS CREATE_DEPT_ID, D_PROD_ORDER.CREATE_DEPT_NAME AS CREATE_DEPT_NAME, D_PROD_ORDER.CREATE_PSN_FID AS CREATE_PSN_FID, D_PROD_ORDER.CREATE_PSN_FNAME AS CREATE_PSN_FNAME, D_PROD_ORDER.CREATE_PSN_ID AS CREATE_PSN_ID, D_PROD_ORDER.CREATE_PSN_NAME AS CREATE_PSN_NAME, D_PROD_ORDER.CREATE_TIME AS CREATE_TIME, D_PROD_ORDER.CY_SEQNR AS CY_SEQNR, D_PROD_ORDER.DELETE_FLAG AS DELETE_FLAG, D_PROD_ORDER.DELIVERED AS DELIVERED, D_PROD_ORDER.DISPO AS DISPO, D_PROD_ORDER.fID AS D_PROD_ORDER, D_PROD_ORDER.ELIKZ AS ELIKZ, D_PROD_ORDER.FEVOR AS FEVOR, D_PROD_ORDER.FORM_STATUS AS FORM_STATUS, D_PROD_ORDER.GAMNG AS GAMNG, D_PROD_ORDER.GLTRI AS GLTRI, D_PROD_ORDER.GMEIN AS GMEIN, D_PROD_ORDER.GSTRI AS GSTRI, D_PROD_ORDER.GSTRP AS GSTRP, D_PROD_ORDER.IGMNG AS IGMNG, D_PROD_ORDER.LOCKED AS LOCKED, D_PROD_ORDER.MASTER_ID AS MASTER_ID, D_PROD_ORDER.MATNR AS MATNR, D_PROD_ORDER.MATXT AS MATXT, D_PROD_ORDER.NOT_QUALIFIED AS NOT_QUALIFIED, D_PROD_ORDER.ORDER_STATUS AS ORDER_STATUS, D_PROD_ORDER.PARAM_FILE AS PARAM_FILE, D_PROD_ORDER.PLAN_CODE AS PLAN_CODE, D_PROD_ORDER.PLAN_FINISH_DATE AS PLAN_FINISH_DATE, D_PROD_ORDER.PLAN_ID AS PLAN_ID, D_PROD_ORDER.PRCTR AS PRCTR, D_PROD_ORDER.PRODCTION_SHIFT AS PRODCTION_SHIFT, D_PROD_ORDER.PROD_DATE AS PROD_DATE, D_PROD_ORDER.RECV_FINISHED AS RECV_FINISHED, D_PROD_ORDER.RELEASE AS RELEASE, D_PROD_ORDER.RSNUM AS RSNUM, D_PROD_ORDER.R_PLNAL AS R_PLNAL, D_PROD_ORDER.R_PLNNR AS R_PLNNR, D_PROD_ORDER.SAP_FLAG AS SAP_FLAG, D_PROD_ORDER.STATUS AS STATUS, D_PROD_ORDER.STLAL AS STLAL, D_PROD_ORDER.STORAGECODE AS STORAGECODE, D_PROD_ORDER.STTXT AS STTXT, D_PROD_ORDER.UEBTO AS UEBTO, D_PROD_ORDER.UNTTO AS UNTTO, D_PROD_ORDER.UPDATE_PSN_ID AS UPDATE_PSN_ID, D_PROD_ORDER.UPDATE_PSN_NAME AS UPDATE_PSN_NAME, D_PROD_ORDER.UPDATE_TIME AS UPDATE_TIME, D_PROD_ORDER.UP_STATUS AS UP_STATUS, D_PROD_ORDER.UP_STATUS_DESC AS UP_STATUS_DESC, D_PROD_ORDER.UP_TIME AS UP_TIME, D_PROD_ORDER.VERID AS VERID, D_PROD_ORDER.WERKS AS WERKS, D_PROD_ORDER.WORKSHOP AS WORKSHOP, D_PROD_ORDER.VERSION AS version FROM D_PROD_ORDER D_PROD_ORDER  WHERE  (DELETE_FLAG = ?) AND (ORDER_STATUS >= ?) AND (CREATE_PSN_FID LIKE ?) AND (AUFNR LIKE ?) AND ( RECV_FINISHED IN (?) )   ORDER BY UPDATE_TIME DESC, binds: [0, 1, /4vd8EGQeqOJlztfkLvv.ogn/kR1oXaJfkTp38wFxOE0.dpt/xMvTeFm6aqqA2bUsnZa.dpt%, %5601%, 1]出错
	at com.justep.exception.BusinessException.create(Unknown Source)
	at com.justep.system.ksql.KSQLUtils.execSqlSelect(Unknown Source)
	... 32 more
Caused by: java.sql.SQLException: No more data to read from socket
	at oracle.jdbc.driver.DatabaseError.throwSqlException(DatabaseError.java:112)
	at oracle.jdbc.driver.DatabaseError.throwSqlException(DatabaseError.java:146)
	at oracle.jdbc.driver.DatabaseError.throwSqlException(DatabaseError.java:208)
	at oracle.jdbc.driver.T4CMAREngine.unmarshalUB1(T4CMAREngine.java:1118)
	at oracle.jdbc.driver.T4CMAREngine.unmarshalSB1(T4CMAREngine.java:1070)
	at oracle.jdbc.driver.T4C8Oall.receive(T4C8Oall.java:478)
	at oracle.jdbc.driver.T4CPreparedStatement.doOall8(T4CPreparedStatement.java:213)
	at oracle.jdbc.driver.T4CPreparedStatement.executeForDescribe(T4CPreparedStatement.java:796)
	at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:1031)
	at oracle.jdbc.driver.T4CPreparedStatement.executeMaybeDescribe(T4CPreparedStatement.java:836)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1124)
	at oracle.jdbc.driver.OraclePreparedStatement.executeInternal(OraclePreparedStatement.java:3285)
	at oracle.jdbc.driver.OraclePreparedStatement.executeQuery(OraclePreparedStatement.java:3329)
	at org.apache.tomcat.dbcp.dbcp.DelegatingPreparedStatement.executeQuery(DelegatingPreparedStatement.java:96)
	at org.apache.tomcat.dbcp.dbcp.DelegatingPreparedStatement.executeQuery(DelegatingPreparedStatement.java:96)
	... 33 more
2018-01-14 02:01:18 [http-8080-4] [com.justep.business.server.BusinessServer] ERROR: excute stream action, params:{"accept":"application/json","action":"queryD_PROD_ORDERAction","actionFlag":"__action_0__","activity":"mainActivity","contentType":"json","executeContext":"","executor":"","parameters":{"columns":"ALLOCATION_NUM,ALLOCAT_FINISHED,AUART,AUART_DESC,AUFNR,AUTYP,AUTYP_DESC,BATCH,BATCH_MGR_FLAG,CONFIRM_FINISHED,CREATE_DEPT_FID,CREATE_DEPT_FNAME,CREATE_DEPT_ID,CREATE_DEPT_NAME,CREATE_PSN_FID,CREATE_PSN_FNAME,CREATE_PSN_ID,CREATE_PSN_NAME,CREATE_TIME,CY_SEQNR,DELETE_FLAG,DELIVERED,DISPO,D_PROD_ORDER,ELIKZ,FEVOR,FORM_STATUS,GAMNG,GLTRI,GMEIN,GSTRI,GSTRP,IGMNG,LOCKED,MASTER_ID,MATNR,MATXT,NOT_QUALIFIED,ORDER_STATUS,PARAM_FILE,PLAN_CODE,PLAN_FINISH_DATE,PLAN_ID,PRCTR,PRODCTION_SHIFT,PROD_DATE,RECV_FINISHED,RELEASE,RSNUM,R_PLNAL,R_PLNNR,SAP_FLAG,STATUS,STLAL,STORAGECODE,STTXT,UEBTO,UNTTO,UPDATE_PSN_ID,UPDATE_PSN_NAME,UPDATE_TIME,UP_STATUS,UP_STATUS_DESC,UP_TIME,VERID,WERKS,WORKSHOP,version","filter":"(DELETE_FLAG='0') AND (ORDER_STATUS>='1') AND ( (CREATE_PSN_FID LIKE '/4vd8EGQeqOJlztfkLvv.ogn/kR1oXaJfkTp38wFxOE0.dpt/xMvTeFm6aqqA2bUsnZa.dpt%')) AND (AUFNR like '%5601%')","limit":20,"offset":0,"orderBy":"UPDATE_TIME DESC","variables":{}},"process":"/eppenpf/pp/process/orderRecv/orderRecvProcess","translateParameter":{"cellnameByRelation":false,"dataType":"row-list","includeState":true,"rowsConfig":{"concept":"D_PROD_ORDER","sequence":"ALLOCATION_NUM,ALLOCAT_FINISHED,AUART,AUART_DESC,AUFNR,AUTYP,AUTYP_DESC,BATCH,BATCH_MGR_FLAG,CONFIRM_FINISHED,CREATE_DEPT_FID,CREATE_DEPT_FNAME,CREATE_DEPT_ID,CREATE_DEPT_NAME,CREATE_PSN_FID,CREATE_PSN_FNAME,CREATE_PSN_ID,CREATE_PSN_NAME,CREATE_TIME,CY_SEQNR,DELETE_FLAG,DELIVERED,DISPO,D_PROD_ORDER,ELIKZ,FEVOR,FORM_STATUS,GAMNG,GLTRI,GMEIN,GSTRI,GSTRP,IGMNG,LOCKED,MASTER_ID,MATNR,MATXT,NOT_QUALIFIED,ORDER_STATUS,PARAM_FILE,PLAN_CODE,PLAN_FINISH_DATE,PLAN_ID,PRCTR,PRODCTION_SHIFT,PROD_DATE,RECV_FINISHED,RELEASE,RSNUM,R_PLNAL,R_PLNNR,SAP_FLAG,STATUS,STLAL,STORAGECODE,STTXT,UEBTO,UNTTO,UPDATE_PSN_ID,UPDATE_PSN_NAME,UPDATE_TIME,UP_STATUS,UP_STATUS_DESC,UP_TIME,VERID,WERKS,WORKSHOP,calcCheckBox,orderStatus,version"},"transformIdcolumn":true,"useNamespace":true}}
java.lang.reflect.InvocationTargetException
	at sun.reflect.GeneratedMethodAccessor190.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:497)
	at com.justep.system.action.Engine.invokeActions(Native Method)
	at com.justep.system.action.Engine.invokeActions(Unknown Source)
	at com.justep.business.server.BusinessServer.doAction(Unknown Source)
	at com.justep.business.server.BusinessServer.doExcute(Unknown Source)
	at com.justep.business.server.BusinessServer.excute(Unknown Source)
	at com.justep.business.server.BusinessServer.excute(Unknown Source)
	at com.justep.business.server.BusinessServerServlet.execService(Unknown Source)
	at com.justep.business.server.BusinessServerServlet.service(Unknown Source)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:723)
	at com.justep.x.bs.BusinessServerServlet.service(Unknown Source)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:723)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)
	at com.googlecode.psiprobe.Tomcat60AgentValve.invoke(Tomcat60AgentValve.java:40)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:103)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:293)
	at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:861)
	at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:606)
	at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:489)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.justep.exception.BusinessException: 编码: JUSTEP150210; 提示: 执行KSQL出错, KSQL: SELECT D_PROD_ORDER.*  FROM D_PROD_ORDER D_PROD_ORDER WHERE ((DELETE_FLAG='0') AND (ORDER_STATUS>='1') AND ( (CREATE_PSN_FID LIKE '/4vd8EGQeqOJlztfkLvv.ogn/kR1oXaJfkTp38wFxOE0.dpt/xMvTeFm6aqqA2bUsnZa.dpt%')) AND (AUFNR like '%5601%')) ORDER BY UPDATE_TIME DESC LIMIT 0, 20
 --> sql: SELECT  D_PROD_ORDER.ALLOCATION_NUM AS ALLOCATION_NUM, D_PROD_ORDER.ALLOCAT_FINISHED AS ALLOCAT_FINISHED, D_PROD_ORDER.AUART AS AUART, D_PROD_ORDER.AUART_DESC AS AUART_DESC, D_PROD_ORDER.AUFNR AS AUFNR, D_PROD_ORDER.AUTYP AS AUTYP, D_PROD_ORDER.AUTYP_DESC AS AUTYP_DESC, D_PROD_ORDER.BATCH AS BATCH, D_PROD_ORDER.BATCH_MGR_FLAG AS BATCH_MGR_FLAG, D_PROD_ORDER.CONFIRM_FINISHED AS CONFIRM_FINISHED, D_PROD_ORDER.CREATE_DEPT_FID AS CREATE_DEPT_FID, D_PROD_ORDER.CREATE_DEPT_FNAME AS CREATE_DEPT_FNAME, D_PROD_ORDER.CREATE_DEPT_ID AS CREATE_DEPT_ID, D_PROD_ORDER.CREATE_DEPT_NAME AS CREATE_DEPT_NAME, D_PROD_ORDER.CREATE_PSN_FID AS CREATE_PSN_FID, D_PROD_ORDER.CREATE_PSN_FNAME AS CREATE_PSN_FNAME, D_PROD_ORDER.CREATE_PSN_ID AS CREATE_PSN_ID, D_PROD_ORDER.CREATE_PSN_NAME AS CREATE_PSN_NAME, D_PROD_ORDER.CREATE_TIME AS CREATE_TIME, D_PROD_ORDER.CY_SEQNR AS CY_SEQNR, D_PROD_ORDER.DELETE_FLAG AS DELETE_FLAG, D_PROD_ORDER.DELIVERED AS DELIVERED, D_PROD_ORDER.DISPO AS DISPO, D_PROD_ORDER.fID AS D_PROD_ORDER, D_PROD_ORDER.ELIKZ AS ELIKZ, D_PROD_ORDER.FEVOR AS FEVOR, D_PROD_ORDER.FORM_STATUS AS FORM_STATUS, D_PROD_ORDER.GAMNG AS GAMNG, D_PROD_ORDER.GLTRI AS GLTRI, D_PROD_ORDER.GMEIN AS GMEIN, D_PROD_ORDER.GSTRI AS GSTRI, D_PROD_ORDER.GSTRP AS GSTRP, D_PROD_ORDER.IGMNG AS IGMNG, D_PROD_ORDER.LOCKED AS LOCKED, D_PROD_ORDER.MASTER_ID AS MASTER_ID, D_PROD_ORDER.MATNR AS MATNR, D_PROD_ORDER.MATXT AS MATXT, D_PROD_ORDER.NOT_QUALIFIED AS NOT_QUALIFIED, D_PROD_ORDER.ORDER_STATUS AS ORDER_STATUS, D_PROD_ORDER.PARAM_FILE AS PARAM_FILE, D_PROD_ORDER.PLAN_CODE AS PLAN_CODE, D_PROD_ORDER.PLAN_FINISH_DATE AS PLAN_FINISH_DATE, D_PROD_ORDER.PLAN_ID AS PLAN_ID, D_PROD_ORDER.PRCTR AS PRCTR, D_PROD_ORDER.PRODCTION_SHIFT AS PRODCTION_SHIFT, D_PROD_ORDER.PROD_DATE AS PROD_DATE, D_PROD_ORDER.RECV_FINISHED AS RECV_FINISHED, D_PROD_ORDER.RELEASE AS RELEASE, D_PROD_ORDER.RSNUM AS RSNUM, D_PROD_ORDER.R_PLNAL AS R_PLNAL, D_PROD_ORDER.R_PLNNR AS R_PLNNR, D_PROD_ORDER.SAP_FLAG AS SAP_FLAG, D_PROD_ORDER.STATUS AS STATUS, D_PROD_ORDER.STLAL AS STLAL, D_PROD_ORDER.STORAGECODE AS STORAGECODE, D_PROD_ORDER.STTXT AS STTXT, D_PROD_ORDER.UEBTO AS UEBTO, D_PROD_ORDER.UNTTO AS UNTTO, D_PROD_ORDER.UPDATE_PSN_ID AS UPDATE_PSN_ID, D_PROD_ORDER.UPDATE_PSN_NAME AS UPDATE_PSN_NAME, D_PROD_ORDER.UPDATE_TIME AS UPDATE_TIME, D_PROD_ORDER.UP_STATUS AS UP_STATUS, D_PROD_ORDER.UP_STATUS_DESC AS UP_STATUS_DESC, D_PROD_ORDER.UP_TIME AS UP_TIME, D_PROD_ORDER.VERID AS VERID, D_PROD_ORDER.WERKS AS WERKS, D_PROD_ORDER.WORKSHOP AS WORKSHOP, D_PROD_ORDER.VERSION AS version FROM D_PROD_ORDER D_PROD_ORDER  WHERE  (DELETE_FLAG = ?) AND (ORDER_STATUS >= ?) AND (CREATE_PSN_FID LIKE ?) AND (AUFNR LIKE ?)   ORDER BY UPDATE_TIME DESC
 --> binds: [0, 1, /4vd8EGQeqOJlztfkLvv.ogn/kR1oXaJfkTp38wFxOE0.dpt/xMvTeFm6aqqA2bUsnZa.dpt%, %5601%]
	at com.justep.exception.BusinessException.create(Unknown Source)
	at com.justep.system.data.impl.TableUtilsImplement.ksqlSelect(Unknown Source)
	at com.justep.system.data.impl.TableUtilsImplement.ksqlSelect(Unknown Source)
	at com.justep.system.data.impl.TableUtilsImplement.ksqlSelect(Unknown Source)
	at com.justep.system.data.BizData.query(Unknown Source)
	at BizProcedure.query(BizProcedure.java:12)
	... 27 more
Caused by: com.justep.exception.BusinessException: 编码: JUSTEP150039; 提示: 执行sql: SELECT  D_PROD_ORDER.ALLOCATION_NUM AS ALLOCATION_NUM, D_PROD_ORDER.ALLOCAT_FINISHED AS ALLOCAT_FINISHED, D_PROD_ORDER.AUART AS AUART, D_PROD_ORDER.AUART_DESC AS AUART_DESC, D_PROD_ORDER.AUFNR AS AUFNR, D_PROD_ORDER.AUTYP AS AUTYP, D_PROD_ORDER.AUTYP_DESC AS AUTYP_DESC, D_PROD_ORDER.BATCH AS BATCH, D_PROD_ORDER.BATCH_MGR_FLAG AS BATCH_MGR_FLAG, D_PROD_ORDER.CONFIRM_FINISHED AS CONFIRM_FINISHED, D_PROD_ORDER.CREATE_DEPT_FID AS CREATE_DEPT_FID, D_PROD_ORDER.CREATE_DEPT_FNAME AS CREATE_DEPT_FNAME, D_PROD_ORDER.CREATE_DEPT_ID AS CREATE_DEPT_ID, D_PROD_ORDER.CREATE_DEPT_NAME AS CREATE_DEPT_NAME, D_PROD_ORDER.CREATE_PSN_FID AS CREATE_PSN_FID, D_PROD_ORDER.CREATE_PSN_FNAME AS CREATE_PSN_FNAME, D_PROD_ORDER.CREATE_PSN_ID AS CREATE_PSN_ID, D_PROD_ORDER.CREATE_PSN_NAME AS CREATE_PSN_NAME, D_PROD_ORDER.CREATE_TIME AS CREATE_TIME, D_PROD_ORDER.CY_SEQNR AS CY_SEQNR, D_PROD_ORDER.DELETE_FLAG AS DELETE_FLAG, D_PROD_ORDER.DELIVERED AS DELIVERED, D_PROD_ORDER.DISPO AS DISPO, D_PROD_ORDER.fID AS D_PROD_ORDER, D_PROD_ORDER.ELIKZ AS ELIKZ, D_PROD_ORDER.FEVOR AS FEVOR, D_PROD_ORDER.FORM_STATUS AS FORM_STATUS, D_PROD_ORDER.GAMNG AS GAMNG, D_PROD_ORDER.GLTRI AS GLTRI, D_PROD_ORDER.GMEIN AS GMEIN, D_PROD_ORDER.GSTRI AS GSTRI, D_PROD_ORDER.GSTRP AS GSTRP, D_PROD_ORDER.IGMNG AS IGMNG, D_PROD_ORDER.LOCKED AS LOCKED, D_PROD_ORDER.MASTER_ID AS MASTER_ID, D_PROD_ORDER.MATNR AS MATNR, D_PROD_ORDER.MATXT AS MATXT, D_PROD_ORDER.NOT_QUALIFIED AS NOT_QUALIFIED, D_PROD_ORDER.ORDER_STATUS AS ORDER_STATUS, D_PROD_ORDER.PARAM_FILE AS PARAM_FILE, D_PROD_ORDER.PLAN_CODE AS PLAN_CODE, D_PROD_ORDER.PLAN_FINISH_DATE AS PLAN_FINISH_DATE, D_PROD_ORDER.PLAN_ID AS PLAN_ID, D_PROD_ORDER.PRCTR AS PRCTR, D_PROD_ORDER.PRODCTION_SHIFT AS PRODCTION_SHIFT, D_PROD_ORDER.PROD_DATE AS PROD_DATE, D_PROD_ORDER.RECV_FINISHED AS RECV_FINISHED, D_PROD_ORDER.RELEASE AS RELEASE, D_PROD_ORDER.RSNUM AS RSNUM, D_PROD_ORDER.R_PLNAL AS R_PLNAL, D_PROD_ORDER.R_PLNNR AS R_PLNNR, D_PROD_ORDER.SAP_FLAG AS SAP_FLAG, D_PROD_ORDER.STATUS AS STATUS, D_PROD_ORDER.STLAL AS STLAL, D_PROD_ORDER.STORAGECODE AS STORAGECODE, D_PROD_ORDER.STTXT AS STTXT, D_PROD_ORDER.UEBTO AS UEBTO, D_PROD_ORDER.UNTTO AS UNTTO, D_PROD_ORDER.UPDATE_PSN_ID AS UPDATE_PSN_ID, D_PROD_ORDER.UPDATE_PSN_NAME AS UPDATE_PSN_NAME, D_PROD_ORDER.UPDATE_TIME AS UPDATE_TIME, D_PROD_ORDER.UP_STATUS AS UP_STATUS, D_PROD_ORDER.UP_STATUS_DESC AS UP_STATUS_DESC, D_PROD_ORDER.UP_TIME AS UP_TIME, D_PROD_ORDER.VERID AS VERID, D_PROD_ORDER.WERKS AS WERKS, D_PROD_ORDER.WORKSHOP AS WORKSHOP, D_PROD_ORDER.VERSION AS version FROM D_PROD_ORDER D_PROD_ORDER  WHERE  (DELETE_FLAG = ?) AND (ORDER_STATUS >= ?) AND (CREATE_PSN_FID LIKE ?) AND (AUFNR LIKE ?)   ORDER BY UPDATE_TIME DESC, binds: [0, 1, /4vd8EGQeqOJlztfkLvv.ogn/kR1oXaJfkTp38wFxOE0.dpt/xMvTeFm6aqqA2bUsnZa.dpt%, %5601%]出错
	at com.justep.exception.BusinessException.create(Unknown Source)
	at com.justep.system.ksql.KSQLUtils.execSqlSelect(Unknown Source)
	... 32 more
Caused by: java.sql.SQLException: OALL8 is in an inconsistent state
	at oracle.jdbc.driver.DatabaseError.throwSqlException(DatabaseError.java:112)
	at oracle.jdbc.driver.DatabaseError.throwSqlException(DatabaseError.java:146)
	at oracle.jdbc.driver.DatabaseError.throwSqlException(DatabaseError.java:208)
	at oracle.jdbc.driver.T4C8Oall.marshal(T4C8Oall.java:352)
	at oracle.jdbc.driver.T4CPreparedStatement.doOall8(T4CPreparedStatement.java:199)
	at oracle.jdbc.driver.T4CPreparedStatement.executeForDescribe(T4CPreparedStatement.java:796)
	at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:1031)
	at oracle.jdbc.driver.T4CPreparedStatement.executeMaybeDescribe(T4CPreparedStatement.java:836)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1124)
	at oracle.jdbc.driver.OraclePreparedStatement.executeInternal(OraclePreparedStatement.java:3285)
	at oracle.jdbc.driver.OraclePreparedStatement.executeQuery(OraclePreparedStatement.java:3329)
	at org.apache.tomcat.dbcp.dbcp.DelegatingPreparedStatement.executeQuery(DelegatingPreparedStatement.java:96)
	at org.apache.tomcat.dbcp.dbcp.DelegatingPreparedStatement.executeQuery(DelegatingPreparedStatement.java:96)
	... 33 more
2018-01-14 02:01:23 [http-8080-4] [com.justep.business.server.BusinessServer] ERROR: excute stream action, params:{"accept":"application/json","action":"queryD_PROD_ORDERAction","actionFlag":"__action_0__","activity":"mainActivity","contentType":"json","executeContext":"","executor":"","parameters":{"columns":"ALLOCATION_NUM,ALLOCAT_FINISHED,AUART,AUART_DESC,AUFNR,AUTYP,AUTYP_DESC,BATCH,BATCH_MGR_FLAG,CONFIRM_FINISHED,CREATE_DEPT_FID,CREATE_DEPT_FNAME,CREATE_DEPT_ID,CREATE_DEPT_NAME,CREATE_PSN_FID,CREATE_PSN_FNAME,CREATE_PSN_ID,CREATE_PSN_NAME,CREATE_TIME,CY_SEQNR,DELETE_FLAG,DELIVERED,DISPO,D_PROD_ORDER,ELIKZ,FEVOR,FORM_STATUS,GAMNG,GLTRI,GMEIN,GSTRI,GSTRP,IGMNG,LOCKED,MASTER_ID,MATNR,MATXT,NOT_QUALIFIED,ORDER_STATUS,PARAM_FILE,PLAN_CODE,PLAN_FINISH_DATE,PLAN_ID,PRCTR,PRODCTION_SHIFT,PROD_DATE,RECV_FINISHED,RELEASE,RSNUM,R_PLNAL,R_PLNNR,SAP_FLAG,STATUS,STLAL,STORAGECODE,STTXT,UEBTO,UNTTO,UPDATE_PSN_ID,UPDATE_PSN_NAME,UPDATE_TIME,UP_STATUS,UP_STATUS_DESC,UP_TIME,VERID,WERKS,WORKSHOP,version","filter":"(DELETE_FLAG='0') AND (ORDER_STATUS>='1') AND ( (CREATE_PSN_FID LIKE '/4vd8EGQeqOJlztfkLvv.ogn/kR1oXaJfkTp38wFxOE0.dpt/xMvTeFm6aqqA2bUsnZa.dpt%')) AND (AUFNR like '%5601%')","limit":20,"offset":0,"orderBy":"UPDATE_TIME DESC","variables":{}},"process":"/eppenpf/pp/process/orderRecv/orderRecvProcess","translateParameter":{"cellnameByRelation":false,"dataType":"row-list","includeState":true,"rowsConfig":{"concept":"D_PROD_ORDER","sequence":"ALLOCATION_NUM,ALLOCAT_FINISHED,AUART,AUART_DESC,AUFNR,AUTYP,AUTYP_DESC,BATCH,BATCH_MGR_FLAG,CONFIRM_FINISHED,CREATE_DEPT_FID,CREATE_DEPT_FNAME,CREATE_DEPT_ID,CREATE_DEPT_NAME,CREATE_PSN_FID,CREATE_PSN_FNAME,CREATE_PSN_ID,CREATE_PSN_NAME,CREATE_TIME,CY_SEQNR,DELETE_FLAG,DELIVERED,DISPO,D_PROD_ORDER,ELIKZ,FEVOR,FORM_STATUS,GAMNG,GLTRI,GMEIN,GSTRI,GSTRP,IGMNG,LOCKED,MASTER_ID,MATNR,MATXT,NOT_QUALIFIED,ORDER_STATUS,PARAM_FILE,PLAN_CODE,PLAN_FINISH_DATE,PLAN_ID,PRCTR,PRODCTION_SHIFT,PROD_DATE,RECV_FINISHED,RELEASE,RSNUM,R_PLNAL,R_PLNNR,SAP_FLAG,STATUS,STLAL,STORAGECODE,STTXT,UEBTO,UNTTO,UPDATE_PSN_ID,UPDATE_PSN_NAME,UPDATE_TIME,UP_STATUS,UP_STATUS_DESC,UP_TIME,VERID,WERKS,WORKSHOP,calcCheckBox,orderStatus,version"},"transformIdcolumn":true,"useNamespace":true}}
java.lang.reflect.InvocationTargetException
	at sun.reflect.GeneratedMethodAccessor190.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:497)
	at com.justep.system.action.Engine.invokeActions(Native Method)
	at com.justep.system.action.Engine.invokeActions(Unknown Source)
	at com.justep.business.server.BusinessServer.doAction(Unknown Source)
	at com.justep.business.server.BusinessServer.doExcute(Unknown Source)
	at com.justep.business.server.BusinessServer.excute(Unknown Source)
	at com.justep.business.server.BusinessServer.excute(Unknown Source)
	at com.justep.business.server.BusinessServerServlet.execService(Unknown Source)
	at com.justep.business.server.BusinessServerServlet.service(Unknown Source)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:723)
	at com.justep.x.bs.BusinessServerServlet.service(Unknown Source)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:723)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)
	at com.googlecode.psiprobe.Tomcat60AgentValve.invoke(Tomcat60AgentValve.java:40)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:103)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:293)
	at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:861)
	at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:606)
	at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:489)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.justep.exception.BusinessException: 编码: JUSTEP150210; 提示: 执行KSQL出错, KSQL: SELECT D_PROD_ORDER.*  FROM D_PROD_ORDER D_PROD_ORDER WHERE ((DELETE_FLAG='0') AND (ORDER_STATUS>='1') AND ( (CREATE_PSN_FID LIKE '/4vd8EGQeqOJlztfkLvv.ogn/kR1oXaJfkTp38wFxOE0.dpt/xMvTeFm6aqqA2bUsnZa.dpt%')) AND (AUFNR like '%5601%')) ORDER BY UPDATE_TIME DESC LIMIT 0, 20
 --> sql: SELECT  D_PROD_ORDER.ALLOCATION_NUM AS ALLOCATION_NUM, D_PROD_ORDER.ALLOCAT_FINISHED AS ALLOCAT_FINISHED, D_PROD_ORDER.AUART AS AUART, D_PROD_ORDER.AUART_DESC AS AUART_DESC, D_PROD_ORDER.AUFNR AS AUFNR, D_PROD_ORDER.AUTYP AS AUTYP, D_PROD_ORDER.AUTYP_DESC AS AUTYP_DESC, D_PROD_ORDER.BATCH AS BATCH, D_PROD_ORDER.BATCH_MGR_FLAG AS BATCH_MGR_FLAG, D_PROD_ORDER.CONFIRM_FINISHED AS CONFIRM_FINISHED, D_PROD_ORDER.CREATE_DEPT_FID AS CREATE_DEPT_FID, D_PROD_ORDER.CREATE_DEPT_FNAME AS CREATE_DEPT_FNAME, D_PROD_ORDER.CREATE_DEPT_ID AS CREATE_DEPT_ID, D_PROD_ORDER.CREATE_DEPT_NAME AS CREATE_DEPT_NAME, D_PROD_ORDER.CREATE_PSN_FID AS CREATE_PSN_FID, D_PROD_ORDER.CREATE_PSN_FNAME AS CREATE_PSN_FNAME, D_PROD_ORDER.CREATE_PSN_ID AS CREATE_PSN_ID, D_PROD_ORDER.CREATE_PSN_NAME AS CREATE_PSN_NAME, D_PROD_ORDER.CREATE_TIME AS CREATE_TIME, D_PROD_ORDER.CY_SEQNR AS CY_SEQNR, D_PROD_ORDER.DELETE_FLAG AS DELETE_FLAG, D_PROD_ORDER.DELIVERED AS DELIVERED, D_PROD_ORDER.DISPO AS DISPO, D_PROD_ORDER.fID AS D_PROD_ORDER, D_PROD_ORDER.ELIKZ AS ELIKZ, D_PROD_ORDER.FEVOR AS FEVOR, D_PROD_ORDER.FORM_STATUS AS FORM_STATUS, D_PROD_ORDER.GAMNG AS GAMNG, D_PROD_ORDER.GLTRI AS GLTRI, D_PROD_ORDER.GMEIN AS GMEIN, D_PROD_ORDER.GSTRI AS GSTRI, D_PROD_ORDER.GSTRP AS GSTRP, D_PROD_ORDER.IGMNG AS IGMNG, D_PROD_ORDER.LOCKED AS LOCKED, D_PROD_ORDER.MASTER_ID AS MASTER_ID, D_PROD_ORDER.MATNR AS MATNR, D_PROD_ORDER.MATXT AS MATXT, D_PROD_ORDER.NOT_QUALIFIED AS NOT_QUALIFIED, D_PROD_ORDER.ORDER_STATUS AS ORDER_STATUS, D_PROD_ORDER.PARAM_FILE AS PARAM_FILE, D_PROD_ORDER.PLAN_CODE AS PLAN_CODE, D_PROD_ORDER.PLAN_FINISH_DATE AS PLAN_FINISH_DATE, D_PROD_ORDER.PLAN_ID AS PLAN_ID, D_PROD_ORDER.PRCTR AS PRCTR, D_PROD_ORDER.PRODCTION_SHIFT AS PRODCTION_SHIFT, D_PROD_ORDER.PROD_DATE AS PROD_DATE, D_PROD_ORDER.RECV_FINISHED AS RECV_FINISHED, D_PROD_ORDER.RELEASE AS RELEASE, D_PROD_ORDER.RSNUM AS RSNUM, D_PROD_ORDER.R_PLNAL AS R_PLNAL, D_PROD_ORDER.R_PLNNR AS R_PLNNR, D_PROD_ORDER.SAP_FLAG AS SAP_FLAG, D_PROD_ORDER.STATUS AS STATUS, D_PROD_ORDER.STLAL AS STLAL, D_PROD_ORDER.STORAGECODE AS STORAGECODE, D_PROD_ORDER.STTXT AS STTXT, D_PROD_ORDER.UEBTO AS UEBTO, D_PROD_ORDER.UNTTO AS UNTTO, D_PROD_ORDER.UPDATE_PSN_ID AS UPDATE_PSN_ID, D_PROD_ORDER.UPDATE_PSN_NAME AS UPDATE_PSN_NAME, D_PROD_ORDER.UPDATE_TIME AS UPDATE_TIME, D_PROD_ORDER.UP_STATUS AS UP_STATUS, D_PROD_ORDER.UP_STATUS_DESC AS UP_STATUS_DESC, D_PROD_ORDER.UP_TIME AS UP_TIME, D_PROD_ORDER.VERID AS VERID, D_PROD_ORDER.WERKS AS WERKS, D_PROD_ORDER.WORKSHOP AS WORKSHOP, D_PROD_ORDER.VERSION AS version FROM D_PROD_ORDER D_PROD_ORDER  WHERE  (DELETE_FLAG = ?) AND (ORDER_STATUS >= ?) AND (CREATE_PSN_FID LIKE ?) AND (AUFNR LIKE ?)   ORDER BY UPDATE_TIME DESC
 --> binds: [0, 1, /4vd8EGQeqOJlztfkLvv.ogn/kR1oXaJfkTp38wFxOE0.dpt/xMvTeFm6aqqA2bUsnZa.dpt%, %5601%]
	at com.justep.exception.BusinessException.create(Unknown Source)
	at com.justep.system.data.impl.TableUtilsImplement.ksqlSelect(Unknown Source)
	at com.justep.system.data.impl.TableUtilsImplement.ksqlSelect(Unknown Source)
	at com.justep.system.data.impl.TableUtilsImplement.ksqlSelect(Unknown Source)
	at com.justep.system.data.BizData.query(Unknown Source)
	at BizProcedure.query(BizProcedure.java:12)
	... 27 more
Caused by: com.justep.exception.BusinessException: 编码: JUSTEP150039; 提示: 执行sql: SELECT  D_PROD_ORDER.ALLOCATION_NUM AS ALLOCATION_NUM, D_PROD_ORDER.ALLOCAT_FINISHED AS ALLOCAT_FINISHED, D_PROD_ORDER.AUART AS AUART, D_PROD_ORDER.AUART_DESC AS AUART_DESC, D_PROD_ORDER.AUFNR AS AUFNR, D_PROD_ORDER.AUTYP AS AUTYP, D_PROD_ORDER.AUTYP_DESC AS AUTYP_DESC, D_PROD_ORDER.BATCH AS BATCH, D_PROD_ORDER.BATCH_MGR_FLAG AS BATCH_MGR_FLAG, D_PROD_ORDER.CONFIRM_FINISHED AS CONFIRM_FINISHED, D_PROD_ORDER.CREATE_DEPT_FID AS CREATE_DEPT_FID, D_PROD_ORDER.CREATE_DEPT_FNAME AS CREATE_DEPT_FNAME, D_PROD_ORDER.CREATE_DEPT_ID AS CREATE_DEPT_ID, D_PROD_ORDER.CREATE_DEPT_NAME AS CREATE_DEPT_NAME, D_PROD_ORDER.CREATE_PSN_FID AS CREATE_PSN_FID, D_PROD_ORDER.CREATE_PSN_FNAME AS CREATE_PSN_FNAME, D_PROD_ORDER.CREATE_PSN_ID AS CREATE_PSN_ID, D_PROD_ORDER.CREATE_PSN_NAME AS CREATE_PSN_NAME, D_PROD_ORDER.CREATE_TIME AS CREATE_TIME, D_PROD_ORDER.CY_SEQNR AS CY_SEQNR, D_PROD_ORDER.DELETE_FLAG AS DELETE_FLAG, D_PROD_ORDER.DELIVERED AS DELIVERED, D_PROD_ORDER.DISPO AS DISPO, D_PROD_ORDER.fID AS D_PROD_ORDER, D_PROD_ORDER.ELIKZ AS ELIKZ, D_PROD_ORDER.FEVOR AS FEVOR, D_PROD_ORDER.FORM_STATUS AS FORM_STATUS, D_PROD_ORDER.GAMNG AS GAMNG, D_PROD_ORDER.GLTRI AS GLTRI, D_PROD_ORDER.GMEIN AS GMEIN, D_PROD_ORDER.GSTRI AS GSTRI, D_PROD_ORDER.GSTRP AS GSTRP, D_PROD_ORDER.IGMNG AS IGMNG, D_PROD_ORDER.LOCKED AS LOCKED, D_PROD_ORDER.MASTER_ID AS MASTER_ID, D_PROD_ORDER.MATNR AS MATNR, D_PROD_ORDER.MATXT AS MATXT, D_PROD_ORDER.NOT_QUALIFIED AS NOT_QUALIFIED, D_PROD_ORDER.ORDER_STATUS AS ORDER_STATUS, D_PROD_ORDER.PARAM_FILE AS PARAM_FILE, D_PROD_ORDER.PLAN_CODE AS PLAN_CODE, D_PROD_ORDER.PLAN_FINISH_DATE AS PLAN_FINISH_DATE, D_PROD_ORDER.PLAN_ID AS PLAN_ID, D_PROD_ORDER.PRCTR AS PRCTR, D_PROD_ORDER.PRODCTION_SHIFT AS PRODCTION_SHIFT, D_PROD_ORDER.PROD_DATE AS PROD_DATE, D_PROD_ORDER.RECV_FINISHED AS RECV_FINISHED, D_PROD_ORDER.RELEASE AS RELEASE, D_PROD_ORDER.RSNUM AS RSNUM, D_PROD_ORDER.R_PLNAL AS R_PLNAL, D_PROD_ORDER.R_PLNNR AS R_PLNNR, D_PROD_ORDER.SAP_FLAG AS SAP_FLAG, D_PROD_ORDER.STATUS AS STATUS, D_PROD_ORDER.STLAL AS STLAL, D_PROD_ORDER.STORAGECODE AS STORAGECODE, D_PROD_ORDER.STTXT AS STTXT, D_PROD_ORDER.UEBTO AS UEBTO, D_PROD_ORDER.UNTTO AS UNTTO, D_PROD_ORDER.UPDATE_PSN_ID AS UPDATE_PSN_ID, D_PROD_ORDER.UPDATE_PSN_NAME AS UPDATE_PSN_NAME, D_PROD_ORDER.UPDATE_TIME AS UPDATE_TIME, D_PROD_ORDER.UP_STATUS AS UP_STATUS, D_PROD_ORDER.UP_STATUS_DESC AS UP_STATUS_DESC, D_PROD_ORDER.UP_TIME AS UP_TIME, D_PROD_ORDER.VERID AS VERID, D_PROD_ORDER.WERKS AS WERKS, D_PROD_ORDER.WORKSHOP AS WORKSHOP, D_PROD_ORDER.VERSION AS version FROM D_PROD_ORDER D_PROD_ORDER  WHERE  (DELETE_FLAG = ?) AND (ORDER_STATUS >= ?) AND (CREATE_PSN_FID LIKE ?) AND (AUFNR LIKE ?)   ORDER BY UPDATE_TIME DESC, binds: [0, 1, /4vd8EGQeqOJlztfkLvv.ogn/kR1oXaJfkTp38wFxOE0.dpt/xMvTeFm6aqqA2bUsnZa.dpt%, %5601%]出错
	at com.justep.exception.BusinessException.create(Unknown Source)
	at com.justep.system.ksql.KSQLUtils.execSqlSelect(Unknown Source)
	... 32 more
Caused by: java.sql.SQLException: Io exception: Broken pipe
	at oracle.jdbc.driver.DatabaseError.throwSqlException(DatabaseError.java:112)
	at oracle.jdbc.driver.DatabaseError.throwSqlException(DatabaseError.java:146)
	at oracle.jdbc.driver.DatabaseError.throwSqlException(DatabaseError.java:255)
	at oracle.jdbc.driver.T4CPreparedStatement.executeForDescribe(T4CPreparedStatement.java:812)
	at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:1031)
	at oracle.jdbc.driver.T4CPreparedStatement.executeMaybeDescribe(T4CPreparedStatement.java:836)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1124)
	at oracle.jdbc.driver.OraclePreparedStatement.executeInternal(OraclePreparedStatement.java:3285)
	at oracle.jdbc.driver.OraclePreparedStatement.executeQuery(OraclePreparedStatement.java:3329)
	at org.apache.tomcat.dbcp.dbcp.DelegatingPreparedStatement.executeQuery(DelegatingPreparedStatement.java:96)
	at org.apache.tomcat.dbcp.dbcp.DelegatingPreparedStatement.executeQuery(DelegatingPreparedStatement.java:96)
	... 33 more
```

10.

```
2018-01-17 16:12:48 [http-8080-1] [com.justep.business.server.BusinessServer] ERROR: excute stream action, params:{"accept":"application/json","action":"updateSALE_ORDERAction","actionFlag":"__action_0__","activity":"mainActivity","contentType":"json","executeContext":"","executor":"","parameters":{},"process":"/eppenpf/sd/process/sd_bill/sd_billProcess"}
java.lang.reflect.InvocationTargetException
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:497)
	at com.justep.system.action.Engine.invokeActions(Native Method)
	at com.justep.system.action.Engine.invokeActions(Unknown Source)
	at com.justep.business.server.BusinessServer.doAction(Unknown Source)
	at com.justep.business.server.BusinessServer.doExcute(Unknown Source)
	at com.justep.business.server.BusinessServer.excute(Unknown Source)
	at com.justep.business.server.BusinessServer.excute(Unknown Source)
	at com.justep.business.server.BusinessServerServlet.execService(Unknown Source)
	at com.justep.business.server.BusinessServerServlet.service(Unknown Source)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:723)
	at com.justep.x.bs.BusinessServerServlet.service(Unknown Source)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:723)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)
	at com.googlecode.psiprobe.Tomcat60AgentValve.invoke(Tomcat60AgentValve.java:40)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:103)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:293)
	at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:861)
	at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:606)
	at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:489)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.justep.exception.BusinessException: 编码: JUSTEP150137; 提示: 列"DETAILID"不存在
	at com.justep.exception.BusinessException.create(Unknown Source)
	at com.justep.util.Utils.check(Unknown Source)
	at com.justep.system.data.impl.TableImpl.deleteColumn(Unknown Source)
	at SDBill.updateSALE_ORDER(SDBill.java:1048)
	... 28 more
```

1048代码

```
batchTable.deleteColumn("DETAILID");
BizData.save(batchTable, mainConcept, null, null, null, null, null, dataModel, null);
```

解决:

可以先判断

```
if (batchTable.getColumnNames().contains("DETAILID")) {
    batchTable.deleteColumn("DETAILID");
}
```


11.

错误信息

```
2018-01-20 02:01:30 [http-8080-2] [com.justep.system.interceptor.LogBefore] ERROR: 执行sql: insert into SA_Log  (sProcessName, sStatusName, sActivity, sAction, sOperatingSystem, version, SID, sProcess, sCreatorPersonName, sCreateTime, sActivityName, sActionName, sParameters, sIP, sTypeName, sDeviceType, $clientName ) values (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, $clientValue ), binds: [系统调用, 失败, mainActivity, loginAction, WINDOWS_7, 0, 096529E0A3064148B66125A1A558A7DF, /SA/OPM/system/systemProcess, yangxiaoyun, 2018-01-20 02:01:29.983, 系统, 登录, ******, 172.16.23.175, 操作日志, Computer]失败
com.justep.exception.BusinessException: 编码: JUSTEP150055; 提示: 在模块"/system/data"下获取数据库连接出错
	at com.justep.exception.BusinessException.create(Unknown Source)
	at com.justep.system.data.Transaction.getConnection(Unknown Source)
	at com.justep.system.data.Transaction.getConnection(Unknown Source)
	at com.justep.system.interceptor.LogBefore.execSqlUpdate(Unknown Source)
	at com.justep.system.interceptor.LogBefore.loginLog(Unknown Source)
	at com.justep.system.interceptor.LogBefore.doActionLog(Unknown Source)
	at com.justep.system.interceptor.LogBefore.execute(Unknown Source)
	at com.justep.system.action.EngineInterceptor.excute(Unknown Source)
	at com.justep.system.action.Engine.invokeActions(Native Method)
	at com.justep.system.action.Engine.invokeActions(Unknown Source)
	at com.justep.business.server.BusinessServer.doAction(Unknown Source)
	at com.justep.business.server.BusinessServer.doExcute(Unknown Source)
	at com.justep.business.server.BusinessServer.excute(Unknown Source)
	at com.justep.business.server.BusinessServerServlet.execService(Unknown Source)
	at com.justep.business.server.BusinessServerServlet.service(Unknown Source)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:723)
	at com.justep.x.bs.BusinessServerServlet.service(Unknown Source)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:723)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)
	at com.googlecode.psiprobe.Tomcat60AgentValve.invoke(Tomcat60AgentValve.java:40)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:103)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:293)
	at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:861)
	at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:606)
	at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:489)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.sql.SQLException: ORA-01033: ORACLE initialization or shutdown in progress

	at oracle.jdbc.driver.DatabaseError.throwSqlException(DatabaseError.java:112)
	at oracle.jdbc.driver.T4CTTIoer.processError(T4CTTIoer.java:331)
	at oracle.jdbc.driver.T4CTTIoer.processError(T4CTTIoer.java:283)
	at oracle.jdbc.driver.T4CTTIoer.processError(T4CTTIoer.java:278)
	at oracle.jdbc.driver.T4CTTIoauthenticate.receiveOsesskey(T4CTTIoauthenticate.java:288)
	at oracle.jdbc.driver.T4CConnection.logon(T4CConnection.java:357)
	at oracle.jdbc.driver.PhysicalConnection.<init>(PhysicalConnection.java:414)
	at oracle.jdbc.driver.T4CConnection.<init>(T4CConnection.java:165)
	at oracle.jdbc.driver.T4CDriverExtension.getConnection(T4CDriverExtension.java:35)
	at oracle.jdbc.driver.OracleDriver.connect(OracleDriver.java:801)
	at org.apache.tomcat.dbcp.dbcp.DriverConnectionFactory.createConnection(DriverConnectionFactory.java:38)
	at org.apache.tomcat.dbcp.dbcp.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:582)
	at org.apache.tomcat.dbcp.pool.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:1185)
	at org.apache.tomcat.dbcp.dbcp.AbandonedObjectPool.borrowObject(AbandonedObjectPool.java:79)
	at org.apache.tomcat.dbcp.dbcp.PoolingDataSource.getConnection(PoolingDataSource.java:106)
	at org.apache.tomcat.dbcp.dbcp.BasicDataSource.getConnection(BasicDataSource.java:1044)
	at com.justep.system.data.Transaction.getConnectionWithJndi(Unknown Source)
	... 30 more
```

原因: 因为oracle有自动备份计划

**更新列表：**

* 





**参考文章：**

* [][1]
* [][2]
* [][3]
* [][4]


[1]: 
[2]: 
[3]: 
[4]: 